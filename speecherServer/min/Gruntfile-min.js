"use strict";var request=require("request");module.exports=function(e){require("time-grunt")(e),require("load-grunt-tasks")(e);var s=35729,r;e.initConfig({pkg:e.file.readJSON("package.json"),develop:{server:{file:"bin/www"}},watch:{options:{nospawn:!0,livereload:s},server:{files:["bin/www","app.js","routes/*.js"],tasks:["develop","delayed-livereload"]},js:{files:["public/js/*.js"],options:{livereload:s}},angular:{files:["public/angularjs/*.js"],options:{livereload:s}},karma:{unit:{configFile:"test/karma.conf.js",singleRun:!0}},plato:{task:{files:{"reports/report-plato":["plato/**/*.js"]}}},css:{files:["public/css/*.css"],options:{livereload:s}},views:{files:["views/*.jade"],options:{livereload:s}}}}),e.config.requires("watch.server.files"),r=e.config("watch.server.files"),r=e.file.expand(r),e.registerTask("delayed-livereload","Live reload after the node server has restarted.",function(){var a=this.async();setTimeout(function(){request.get("http://localhost:"+s+"/changed?files="+r.join(","),function(s,r){var i=!s&&200===r.statusCode;i?e.log.ok("Delayed live reload successful."):e.log.error("Unable to make a delayed live reload."),a(i)})},500)}),e.registerTask("default",["develop","watch","karma"])};